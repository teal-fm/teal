CREATE MATERIALIZED VIEW "public"."mv_top_releases_per_user_30days" AS (select "plays"."did", "releases"."mbid", "releases"."name", count("plays"."uri") as "play_count" from "releases" inner join "plays" on "plays"."release_mbid" = "releases"."mbid" where "plays"."played_time" >= NOW() - INTERVAL '30 days' group by "plays"."did", "releases"."mbid", "releases"."name" order by count("plays"."uri") DESC);